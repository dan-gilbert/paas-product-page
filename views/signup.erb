<% content_for :head do %>
	<title>Request Account - <%= settings.title %></title>
<% end %>

<nav class="breadcrumbs" aria-label="Breadcrumbs">
	<ol itemscope itemtype="http://schema.org/BreadcrumbList">
		<li class="breadcrumbs__item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<a href="https://www.gov.uk/service-toolkit#components" itemprop="item">
				<span itemprop="name">Components</span>
			</a>
		</li>
		<li class="breadcrumbs__item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<a href="/" itemprop="item">
				<span itemprop="name">GOV.UK PaaS</span>
			</a>
		</li>
		<li class="breadcrumbs__item breadcrumbs__item--active" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<a href="#main" itemprop="item">
				<span itemprop="name">Request an account</span>
			</a>
		</li>
	</ol>
</nav>

<div class="container">
	<div class="grid-row">
		<div class="column-full filter-fields">
			<div class="back">
				<a href="/" class="link-back step-back">Back</a>
			</div>
		</div>
		<div class="column-two-thirds">
			<h1 class="heading-large">Request a Gov.UK PaaS account</h1>
			<% if @errors && @errors.size > 0 %>
				<div class="error-summary" role="alert" aria-labelledby="error-summary-heading-example-1" tabindex="-1">
					<h2 class="heading-medium error-summary-heading" id="error-summary-heading-example-1">There were problems submitting your request</h2>
					<ul class="error-summary-list">
						<% @errors.each do |field, err| %>
							<li class="err"><a href="#" class="focus-field" data-field="<%= field.to_s %>"><%= err %></a></li>
						<% end %>
					</ul>
				</div>
			<% end %>
			<form action="/signup" method="post">

				<div class="step step--join-organisation">
					<p>If your team is already using GOV.UK PaaS and you would like a user account, ask your Org Manager to contact us and make a request at:<br><a href="mailto:gov-uk-paas-support@digital.cabinet-office.gov.uk">gov-uk-paas-support@digital.cabinet-office.gov.uk</a></p>
					<p>Org Managers administer the account and assign roles and permissions.</p>
					<p>Users with non-government email addresses can be added to an account at the request of an Org Manager.</p>
					<div class="form-group">
						<a class="button button-start" href="/contact-us">Contact Support</a> </p>
					</div>
				</div>

				<div class="step step--start step--all">
					<p>Service teams on GOV.UK PaaS own and use a development account called an <em>organisation</em>.</p>
					<div class="form-group">
						<fieldset>
							<legend>
								<span class="form-label-bold">Do you want to create an Organisation?</span>
								<span class="form-hint">An organisation typically represents the real-world organisation, department or team you work for.</span>
							</legend>
							<div class="multiple-choice">
								<input id="choose-create" type="radio" name="step" value="step--about-you" checked="checked">
								<label for="choose-create">Yes, I'm new to PaaS and want to create an organisation</label>

							</div>
							<div class="multiple-choice">
								<input id="choose-join" type="radio" name="step" value="step--join-organisation">
								<label for="choose-join">No, I'd like to join an existing organisation</label>
							</div>
						</fieldset>
					</div>
					<div class="form-group">
						<button class="button step-button step--1-button" style="display:none;" disabled="disabled">Continue</button>
					</div>
				</div>

				<div class="step step--about-you step--all">
					<h2 class="heading-medium">Your contact details</h2>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :person_name %> form-group--person_name">
						<label class="form-label" for="person_name">
							<span class="form-label-bold">Name</span>
							<span class="form-hint">Your full name</span>
							<span class="error-message"><%= @errors[:person_name] %></span>
						</label>
						<input class="form-control" type="text" name="person_name" style="width: 100%;" value="<%= @form[:person_name] || '' %>">
					</div>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :person_email %> form-group--person_email">
						<label class="form-label" for="person_email">
							<span class="form-label-bold">Email address</span>
							<span class="form-hint">We can only accept requests from government organisation addresses</span>
							<span class="error-message"><%= @errors[:person_email] %></span>
						</label>
						<input class="form-control" id="email-address" type="text" name="person_email" style="width: 100%;" value="<%= @form[:person_email] || ''%>">
					</div>
					<div class="form-group">
						<input type="hidden" name="step" value="step--create-organisation">
						<button class="button step-button" style="display:none;">Continue</button>
					</div>
				</div>

				<div class="step step--create-organisation step--all">
					<h2 class="heading-medium">Your organisation</h2>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :department_name %> form-group--department_name">
						<label class="form-label" for="department_name">
							<span class="form-label-bold">Department or agency name</span>
							<span class="form-hint">The name of your government department or agency</span>
							<span class="error-message"><%= @errors[:department_name] %></span>
						</label>
						<input class="form-control" id="dep-name" type="text" name="department_name" style="width: 100%;" value="<%= @form[:department_name] || ''%>">
					</div>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :service_name %> form-group--service_name">
						<label class="form-label" for="service_name">
							<span class="form-label-bold">Service or team name</span>
							<span class="form-hint">The name of the service, team or project you work on. If you’re not working on a service please tell us the name of your team or what you want to use Gov.UK PaaS for</span>
							<span class="error-message"><%= @errors[:service_name] %></span>
						</label>
						<input class="form-control" id="service-name" type="text" name="service_name" style="width: 100%;" value="<%= @form[:service_name] || '' %>">
					</div>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :person_is_manager %>">
						<fieldset>
							<legend>
								<span class="form-label-bold">Will you be a manager of this organisation?</span>
								<span class="form-hint">Organisations are controlled by <em>Org Managers</em> who are responsible for administering the account and assigning roles and permissions to users within the organisation.</span>
								<span class="error-message"><%= @errors[:person_is_manager] %></span>
							</legend>
							<div class="multiple-choice">
								<input id="person-is-manager-yes" class="person-is-manager" type="radio" name="person_is_manager" value="true" <%= 'checked="checked"' if @form[:person_is_manager] === true or @form[:person_is_manager].nil? %>>
								<label for="person-is-manager-yes">Yes, I will be a manager for this organisation</label>
							</div>
							<div class="multiple-choice">
								<input id="person-is-manager-no" class="person-is-manager" type="radio" name="person_is_manager" value="false" <%= 'checked="checked"' if @form[:person_is_manager] === false %>>
								<label for="person-is-manager-no">No, I will nominate someone else to be a manager</label>
							</div>
							<div id="person-is-manager-no--note" class="panel panel-border-narrow" style="display:none; margin-top: 10px;">
								<p>You will need to specify at least one <em>Org Manager</em> in order for us to set up your Organisation.</p>
								<p>If you do not intend to be the <em>Org Manager</em> yourself you can invite your nominated manager on the following page.</p>
							</div>
						</fieldset>
					</div>
					<div class="form-group">
						<input type="hidden" name="step" value="step--invite-users">
						<button class="button step-button" style="display:none;">Continue</button>
					</div>
				</div>

				<div class="step step--invite-users step--all">
					<h2 class="heading-medium">Invite users to your organisation</h2>
					<p>Multiple users can be given access to your <em>Organisation</em>.</p>
					<p>Users who aren’t Org Managers won’t be able to administer the account, but will be given rights to deploy code.</p>
					<div class="form-group <%= 'form-group-error' if @errors.has_key? :invites %>">
						<fieldset>
							<legend>
								<span class="form-label-bold">Would you like to invite additional users now?</span>
								<span class="form-hint">We recormend each <em>Organisation</em> has at least two <em>Org Managers</em></span>
								<span class="error-message"><%= @errors[:invites] %></span>
							</legend>
							<div class="multiple-choice">
								<input id="invite-radio-yes" class="invite-radio" type="radio" name="invite_users" value="true" <%= 'checked="checked"' if @form[:invite_users] === true or @form[:invite_users].nil? %>>
								<label for="invite-radio-yes">Yes, I'd like to invite users to my Organisation</label>
							</div>
							<div class="panel panel-border-narrow" id="invite-table">
								<table>
									<thead>
										<tr>
											<th scope="col" style="text-align:left;">Full Name</th>
											<th class="numeric" scope="col" style="text-align:left;">Email Address</th>
											<th class="numeric" scope="col" colspan="2" style="text-align:left;">Is Org Manager</th>
										</tr>
									</thead>
									<tbody>
										<% 3.times do |i| %>
											<tr>
												<td class="numeric">
													<input style="width:100%;" class="form-control" type="text" placeholder="Name" name="invites[<%= i %>]person_name" value="<%= @form[:invites][i][:person_name] %>">
												</td>
												<td class="numeric">
													<input style="width:100%;" class="form-control" type="text" placeholder="user@email.com" name="invites[<%= i %>]person_email" value="<%= @form[:invites][i][:person_email] || '' %>">
												</td>
												<td class="numeric" style="width:50px">
													<div class="multiple-choice">
														<input id="manager-checkbox-<%= i %>" name="invites[<%= i %>]person_is_manager" type="checkbox" value="true" <%= 'checked="checked"' if @form[:invites][i][:person_is_manager] %>>
														<label for="manager-checkbox-<%= i %>">&nbsp;</label>
													</div>
												</td>
											</tr>
										<% end %>
									</tbody>
								</table>
							</div>
							<div class="multiple-choice">
								<input id="invite-radio-no" class="invite-radio" type="radio" name="invite_users" value="false" <%= 'checked="checked"' if @form[:invite_users] === false %>>
								<label for="invite-radio-no">No, I'll do this later</label>
							</div>
						</fieldset>
					</div>
					<div class="form-group">
						<button id="signup-submit" type="submit" class="button button-start">Submit</button>
					</div>
				</div>

			</form>
		</div>
		<div class="column-one-third"></div>
	</div>
</div>

<div class="container">
	<div class="grid-row">
	</div>
</div>

